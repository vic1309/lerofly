---
layout: post
title:  "Numerical Methods - Euler Method"
date:   2019-06-12 22:15:00
author: Victor de Aguiar
categories: ODE
text-align: justify
tags:	ode numerical euler
mathjax: true
cover:  "/assets/capa_ode.jpg"
---
**Hello, world! Welcome!**

We have finally reached the last topic on our journey! Before going deeper and attack it, let's build an intuitive understanding about the problem.

> **- Why should we care about systems of linear ODEs?**

<p align="justify">
  When we consider a linear system of something it means that things are <b>coupled, linked</b>. In other words, if you have two equations with two unknown functions (say $x_1$ and $x_2$) the knowledge of $x_2$ is required to find $x_1$ and the contrary is also true. However, differently from secondary school where we learned how to solve a system of <i>algebraic</i> equations, now we are going to see how to solve a system composed by <i>differential</i> equations. Let's take a look on some examples?
</p>

<p align="justify"> <i><b>Ex. 1:</b></i> <i>Suppose that you have a system which contains two springs with constants $k_1$ and $k_2$ connected by two blocks with masses $m_1$ and $m_2$ moving on a surface that creates friction ($b_1$ and $b_2$). Consider that the tip of the first spring is fixed and when no external forces act on them their length are $L_1$ and $L_2$. Finally, consider that the position of the blocks are denoted by $x_1$ and $x_2$, respectively (Figure 1).</i> </p>

> *Taking into account those considerations and apllying Newton's Second Law we find that:*

> $$\begin{equation} m_1 \frac{d^2 x_1}{dt^2} + b_1 \frac{d x_1}{dt} + k_1(x_1 - L_1) - k_2(x_2 - x_1 - L_2) = 0 \tag{1} \label{eq:one} \end{equation}$$

> $$\begin{equation} m_2 \frac{d^2 x_2}{dt^2} + b_2 \frac{d x_2}{dt} + k_2(x_2 - x_1 - L_2) = 0 \tag{2} \label{eq:two} \end{equation}$$

> Defining parameter values:

* Block masses: &ensp; $m_1 = 1.0$, &ensp; $m_2 = 1.5$ 
* Spring constants: &ensp; $k_1 = 8.0$, &ensp; $k_2 = 40.0$ 
* Lengths: &ensp; $L_1 = 0.5$, &ensp; $L_2 = 1.0$ 
* Friction coefficients: &ensp; $b_1 = 0.8$, &ensp; $b_2 = 0.5$

> and initial conditions:

* Initial position: &ensp; $x_1 = 0.5$, &ensp; $x_2 = 2.25$
* Initial velocity: &ensp; $\frac{d x_1}{dt} = y_1 = 0$, &ensp; $\frac{d x_2}{dt} = y_2 = 0$ 

Thus, we are able to transform two second order equations into a system of four first order equations.

As you probably have already noticed, we are going to use Linear Algebra in order to solve such problems. For that reason, it's worth to spend a time learning/recapitulating specific points about it. On this first part, I am going to present general ideas about *linear transformation*, *linear independence* and *eigenvalues and eigenvectors*. This knowledge is going to be extremely useful when solving linear systems of ODEs later.

For this first chapter I recommend the following reading/watching list:

- [Essence of Linear Algebra](https://www.youtube.com/watch?v=fNk_zzaMoSs&list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab) - **3BLue1Brown**

- [Introduction to Applied Linear Algebra - Vectors, Matrices, and Least Squares](http://vmls-book.stanford.edu/vmls.pdf) - **Stephen Boyd**

- [Linear ALgebra](https://www.math.ucdavis.edu/~linear/linear-guest.pdf) - **David Cherney, Tom Denton, Rohit Thomas and Andrew Waldron**

- [Linear Algebra and its applications](http://www.math.hcmus.edu.vn/~bxthang/Linear%20algebra%20and%20its%20applications.pdf) - **Gilbert Strang**

- [Introduction to Linear Algebra](http://www.math.nagoya-u.ac.jp/~richard/teaching/f2014/Lin_alg_Lang.pdf) - **Serge Lang**

- [Handbook of Linear Algebra](http://www2.fiit.stuba.sk/~kvasnicka/QuantumComputing/Hogben-Handbook%20of%20Linear%20Algebra-%28CRC%20press,%202007%29.pdf) - **Leslie Hogben**

----
----

### Theoretical Background

$$\begin{equation} y_{n+1} = y_{n} + f_{n}h \tag{5} \label{eq:fv} \end{equation}$$

### Examples

> <i><b> Ex. 1: </b> Consider the following initial value problem:</i>

> $$\begin{equation} \frac{dy}{dt} = 3 + e^{-t} - \frac{1}{2}y, \qquad y(0) = 1 \tag{6} \label{eq:six} \end{equation}$$

> <i>Use the Euler Method with step sizes (h) 0.1, 0.05, 0.025 and 0.01 to approximate a numerical solution between $$ 0 \leq t \leq 5 $$. Compare results with the analytical solution respective values.</i> 

In order to find de exact solution $$\phi(t)$$ we must apply the integrating factor method. We have learned how to use it and once that this is not the goal of this section I will leave this work for the reader. After applying it, you will find that the exact solution is given by:

$$\begin{equation} y = \phi(t) = 6 - 2e^{t} - 3e^{\frac{t}{2}} \tag{7} \label{eq:svn} \end{equation}$$  

To apply Euler's Method formula (see Eq. \ref{eq:fv}) we must define $$y_{n}$$, $$f_{n}$$ and the step size *h* to find the next value $$y_{n+1}$$ of our function. For this specific problem, $$f(t,y) = 3 + e^{-t} - \frac{y}{2}$$ and for the initial point, *i.e.* n = 0, we have that $$\mathbf{t_{0} = 0}$$ and $$\mathbf{y_{0} = 1}$$. Hence:

$$ \begin{equation} f_{0} = f(t_{0}, y_{0}) = f(0, 1) = 3 + e^{-t_{0}} - \frac{y_{0}}{2} = 3 + e^{0} - 0.5 = 3.5 \end{equation}$$ 

Using Eq. \ref{eq:fv} and considering *h* = 0.1:

$$\begin{equation} y_{1} = y_{0} + f_{0}h \implies y_{1} = 1 + (3.5)(0.1) = 1.35 \end{equation}$$

Now, to find the numerical approximation for one step ahead ($$y_{n+1} = y_{2}$$) we must find the new value of *f(t,y)*, which is:

$$ \begin{equation} f_{1} = f(t_{n}, y{n}) = f(0.1, 1.35) = 3 + e^{-0.1} - (0.5)(1.35) \approx 3.229837 \end{equation}$$

----

## Eigenvalues and Eigenvectors


----

Cover image by [Earth Observatory - Nasa](https://earthobservatory.nasa.gov/images/41161/katabatic-winds-rake-antarcticas-terra-nova-bay)

[jekyll]:      http://jekyllrb.com
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-help]: https://github.com/jekyll/jekyll-help
[highlight]:   https://highlightjs.org/
[lightbox]:    http://lokeshdhakar.com/projects/lightbox2/
[jekyll-archive]: https://github.com/jekyll/jekyll-archives
[liquid]: https://github.com/Shopify/liquid/wiki/Liquid-for-Designers
